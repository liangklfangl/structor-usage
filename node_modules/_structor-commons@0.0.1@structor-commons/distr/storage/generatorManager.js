"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t]);return n.default=e,n}function installDependencies(e){var n=Promise.resolve();if(e){var t=e.packages,r=e.scripts;if(t&&t.length>0){var i="";t.forEach(function(e){n=n.then(function(){return(0,_npmUtils.getPackageAbsolutePath)(e.name,config.getProjectDir()).then(function(n){if(!n){var t=e.version&&e.version.trim().length>0?"@"+e.version.trim():"";i+=e.name+t+" "}})})}),n=n.then(function(){if(i=i.substr(0,i.length-1),i&&i.length>0)return(0,_npmUtils.installPackages)(i,config.getProjectDir())})}r&&!(0,_lodash.isEmpty)(r)&&(n=n.then(function(){return(0,_npmUtils.appendScripts)(r,config.getProjectDir())}))}return n}function saveGenerated(e,n){return installDependencies(e).then(function(){var e=[];return n.forEach(function(n){e.push((0,_fileManager.ensureFilePath)(n.outputFilePath).then(function(){return(0,_fileManager.writeFile)(n.outputFilePath,n.sourceCode,!1)}))}),Promise.all(e)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.installDependencies=installDependencies,exports.saveGenerated=saveGenerated;var _lodash=require("lodash"),_configuration=require("../configuration.js"),config=_interopRequireWildcard(_configuration),_fileManager=require("../commons/fileManager.js"),_npmUtils=require("../commons/npmUtils.js");