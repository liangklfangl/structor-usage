"use strict";function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var n={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n["default"]=e,n}function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function repairPath(e){return"."!==e.substr(0,1)&&(e="./"+e),e}function initGeneratorData(e,n,r,t){return indexManager.initIndex().then(function(i){var a=[],o=config.getProjectConfig(),u={};return a.push(fileManager.readFile(config.deskIndexFilePath()).then(function(e){u.deskIndexFile=e})),a.push(fileManager.readFile(config.deskReducersFilePath()).then(function(e){u.deskReducersFile=e})),a.push(fileManager.readFile(config.deskSagasFilePath()).then(function(e){u.deskSagasFile=e})),_promise2["default"].all(a).then(function(){return o.sources=u,{groupName:e,componentName:n,model:r,metadata:t,project:o,index:i}})})}function installDependencies(e){if(e){var n=e.packages;if(n&&n.length>0){var r=function(){var e=_promise2["default"].resolve(),r="";return n.forEach(function(n){e=e.then(function(){return npmUtils.getPackageAbsolutePath(n.name,config.projectDir()).then(function(e){if(!e){var t=n.version&&n.version.trim().length>0?"@"+n.version.trim():"";r+=n.name+t+" "}})})}),e=e.then(function(){if(r=r.substr(0,r.length-1),r&&r.length>0)return npmUtils.installPackages(r,config.projectDir())}),{v:e}}();if("object"===("undefined"==typeof r?"undefined":(0,_typeof3["default"])(r)))return r.v}}return _promise2["default"].resolve()}function saveGenerated(e,n,r){var t=[],i=void 0;return r.forEach(function(e){e.isComponent&&(i=e.outputFilePath),t.push(fileManager.ensureFilePath(e.outputFilePath).then(function(){return fileManager.writeFile(e.outputFilePath,e.sourceCode,!1)}))}),_promise2["default"].all(t).then(function(){return indexManager.initIndex()})}Object.defineProperty(exports,"__esModule",{value:!0});var _typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);exports.initGeneratorData=initGeneratorData,exports.installDependencies=installDependencies,exports.saveGenerated=saveGenerated;var _lodash=require("lodash"),_path=require("path"),_path2=_interopRequireDefault(_path),_fileManager=require("../commons/fileManager.js"),fileManager=_interopRequireWildcard(_fileManager),_configuration=require("../commons/configuration.js"),config=_interopRequireWildcard(_configuration),_indexManager=require("../commons/indexManager.js"),indexManager=_interopRequireWildcard(_indexManager),_npmUtils=require("../commons/npmUtils.js"),npmUtils=_interopRequireWildcard(_npmUtils);